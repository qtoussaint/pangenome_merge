/nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_clusters.m8 exists and will be overwritten
easy-search /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_1/pan_genome_reference.fa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_2/pan_genome_reference.fa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_clusters.m8 /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp --search-type 2 --format-mode 4 -a --format-output query,target,fident,nident,alnlen,qlen,tlen,evalue 

MMseqs Version:                        	17.b804f
Substitution matrix                    	aa:blosum62.out,nucl:nucleotide.out
Add backtrace                          	true
Alignment mode                         	3
Alignment mode                         	0
Allow wrapped scoring                  	false
E-value threshold                      	0.001
Seq. id. threshold                     	0
Min alignment length                   	0
Seq. id. mode                          	0
Alternative alignments                 	0
Coverage threshold                     	0
Coverage mode                          	0
Max sequence length                    	65535
Compositional bias                     	1
Compositional bias                     	1
Max reject                             	2147483647
Max accept                             	2147483647
Include identical seq. id.             	false
Preload mode                           	0
Pseudo count a                         	substitution:1.100,context:1.400
Pseudo count b                         	substitution:4.100,context:5.800
Score bias                             	0
Realign hits                           	false
Realign score bias                     	-0.2
Realign max seqs                       	2147483647
Correlation score weight               	0
Gap open cost                          	aa:11,nucl:5
Gap extension cost                     	aa:1,nucl:2
Zdrop                                  	40
Threads                                	48
Compressed                             	0
Verbosity                              	3
Seed substitution matrix               	aa:VTML80.out,nucl:nucleotide.out
Sensitivity                            	5.7
k-mer length                           	0
Target search mode                     	0
k-score                                	seq:2147483647,prof:2147483647
Alphabet size                          	aa:21,nucl:5
Max results per query                  	300
Split database                         	0
Split mode                             	2
Split memory limit                     	0
Diagonal scoring                       	true
Exact k-mer matching                   	0
Mask residues                          	1
Mask residues probability              	0.9
Mask lower case residues               	0
Mask lower letter repeating N times    	0
Minimum diagonal score                 	15
Selected taxa                          	
Spaced k-mers                          	1
Spaced k-mer pattern                   	
Local temporary path                   	
Use GPU                                	0
Use GPU server                         	0
Wait for GPU server                    	600
Prefilter mode                         	0
Rescore mode                           	0
Remove hits by seq. id. and coverage   	false
Sort results                           	0
Mask profile                           	1
Profile E-value threshold              	0.001
Global sequence weighting              	false
Allow deletions                        	false
Filter MSA                             	1
Use filter only at N seqs              	0
Maximum seq. id. threshold             	0.9
Minimum seq. id.                       	0.0
Minimum score per column               	-20
Minimum coverage                       	0
Select N most diverse seqs             	1000
Pseudo count mode                      	0
Profile output mode                    	0
Min codons in orf                      	30
Max codons in length                   	32734
Max orf gaps                           	2147483647
Contig start mode                      	2
Contig end mode                        	2
Orf start mode                         	1
Forward frames                         	1,2,3
Reverse frames                         	1,2,3
Translation table                      	1
Translate orf                          	0
Use all table starts                   	false
Offset of numeric ids                  	0
Create lookup                          	0
Overlap between sequences              	0
Sequence split mode                    	1
Header split mode                      	0
Chain overlapping alignments           	0
Merge query                            	1
Search type                            	2
Search iterations                      	1
Start sensitivity                      	4
Search steps                           	1
Exhaustive search mode                 	false
Filter results during exhaustive search	0
Strand selection                       	1
LCA search mode                        	false
Disk space limit                       	0
MPI runner                             	
Force restart with latest tmp          	false
Remove temporary files                 	true
Translation mode                       	0
Alignment format                       	4
Format alignment output                	query,target,fident,nident,alnlen,qlen,tlen,evalue
Database output                        	false
Overlap threshold                      	0
Database type                          	0
Shuffle input database                 	true
Createdb mode                          	0
Write lookup file                      	0
Greedy best hits                       	false

createdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_1/pan_genome_reference.fa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query --dbtype 0 --shuffle 0 --createdb-mode 0 --write-lookup 0 --id-offset 0 --compressed 0 -v 3 

Converting sequences
[
Time for merging to query_h: 0h 0m 0s 2ms
Time for merging to query: 0h 0m 0s 1ms
Database type: Nucleotide
Time for processing: 0h 0m 0s 33ms
createdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_2/pan_genome_reference.fa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target --dbtype 0 --shuffle 1 --createdb-mode 0 --write-lookup 0 --id-offset 0 --compressed 0 -v 3 

Converting sequences
[
Time for merging to target_h: 0h 0m 0s 107ms
Time for merging to target: 0h 0m 0s 134ms
Database type: Nucleotide
Time for processing: 0h 0m 0s 490ms
Create directory /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp
search /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/result /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp -a 1 --alignment-mode 3 -s 5.7 --search-type 2 --remove-tmp-files 1 

extractorfs /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/q_orfs_aa --min-length 30 --max-length 32734 --max-gaps 2147483647 --contig-start-mode 2 --contig-end-mode 2 --orf-start-mode 1 --forward-frames 1,2,3 --reverse-frames 1,2,3 --translation-table 1 --translate 1 --use-all-table-starts 0 --id-offset 0 --create-lookup 0 --threads 48 --compressed 0 -v 3 

[=================================================================] 2.98K 0s 154ms
Time for merging to q_orfs_aa_h: 0h 0m 0s 201ms
Time for merging to q_orfs_aa: 0h 0m 0s 219ms
Time for processing: 0h 0m 0s 956ms
extractorfs /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/t_orfs_aa --min-length 30 --max-length 32734 --max-gaps 2147483647 --contig-start-mode 2 --contig-end-mode 2 --orf-start-mode 1 --forward-frames 1,2,3 --reverse-frames 1,2,3 --translation-table 1 --translate 1 --use-all-table-starts 0 --id-offset 0 --create-lookup 0 --threads 48 --compressed 0 -v 3 

[=================================================================] 2.96K 0s 144ms
Time for merging to t_orfs_aa_h: 0h 0m 0s 201ms
Time for merging to t_orfs_aa: 0h 0m 0s 228ms
Time for processing: 0h 0m 0s 960ms
prefilter /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/q_orfs_aa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/t_orfs_aa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/search/pref_0 --sub-mat 'aa:blosum62.out,nucl:nucleotide.out' --seed-sub-mat 'aa:VTML80.out,nucl:nucleotide.out' -k 0 --target-search-mode 0 --k-score seq:2147483647,prof:2147483647 --alph-size aa:21,nucl:5 --max-seq-len 65535 --max-seqs 300 --split 0 --split-mode 2 --split-memory-limit 0 -c 0 --cov-mode 0 --comp-bias-corr 1 --comp-bias-corr-scale 1 --diag-score 1 --exact-kmer-matching 0 --mask 1 --mask-prob 0.9 --mask-lower-case 0 --mask-n-repeat 0 --min-ungapped-score 15 --add-self-matches 0 --spaced-kmer-mode 1 --db-load-mode 0 --pca substitution:1.100,context:1.400 --pcb substitution:4.100,context:5.800 --threads 48 --compressed 0 -v 3 -s 5.7 

Query database size: 30144 type: Aminoacid
Estimated memory consumption: 1G
Target database size: 29938 type: Aminoacid
Index table k-mer threshold: 112 at k-mer size 6 
Index table: counting k-mers
[=================================================================] 29.94K 0s 411ms
Index table: Masked residues: 18360
Index table: fill
[=================================================================] 29.94K 0s 451ms
Index statistics
Entries:          1772274
DB size:          498 MB
Avg k-mer size:   0.027692
Top 10 k-mers
    LLLLLL	18
    GPGGTL	14
    LLLLLS	12
    SSSSSS	12
    VDPPPT	11
    LLQLLL	10
    LILLHL	9
    LLLFLL	9
    QLLLLL	9
    LLKLSL	9
Time for index table init: 0h 0m 1s 458ms
Process prefiltering step 1 of 1

k-mer similarity threshold: 112
Starting prefiltering scores calculation (step 1 of 1)
Query db start 1 to 30144
Target db start 1 to 29938
[=================================================================] 30.14K 14s 40ms

208.800424 k-mers per position
500 DB matches per sequence
0 overflows
7 sequences passed prefiltering per query sequence
5 median result list length
147 sequences with 0 size result lists
Time for merging to pref_0: 0h 0m 0s 126ms
Time for processing: 0h 0m 18s 685ms
align /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/q_orfs_aa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/t_orfs_aa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/search/pref_0 /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/aln --sub-mat 'aa:blosum62.out,nucl:nucleotide.out' -a 1 --alignment-mode 3 --alignment-output-mode 0 --wrapped-scoring 0 -e 0.001 --min-seq-id 0 --min-aln-len 0 --seq-id-mode 0 --alt-ali 0 -c 0 --cov-mode 0 --max-seq-len 65535 --comp-bias-corr 1 --comp-bias-corr-scale 1 --max-rejected 2147483647 --max-accept 2147483647 --add-self-matches 0 --db-load-mode 0 --pca substitution:1.100,context:1.400 --pcb substitution:4.100,context:5.800 --score-bias 0 --realign 0 --realign-score-bias -0.2 --realign-max-seqs 2147483647 --corr-score-weight 0 --gap-open aa:11,nucl:5 --gap-extend aa:1,nucl:2 --zdrop 40 --threads 48 --compressed 0 -v 3 

Compute score, coverage and sequence identity
Query database size: 30144 type: Aminoacid
Target database size: 29938 type: Aminoacid
Calculation of alignments
[=================================================================] 30.14K 4s 565ms
Time for merging to aln: 0h 0m 0s 125ms
212125 alignments calculated
37566 sequence pairs passed the thresholds (0.177094 of overall calculated)
1.246218 hits per query sequence
Time for processing: 0h 0m 4s 941ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/search/pref_0 -v 3 

Time for processing: 0h 0m 0s 90ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/search/aln_0 -v 3 

Time for processing: 0h 0m 0s 0ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/search/input_0 -v 3 

Time for processing: 0h 0m 0s 0ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/search/aln_merge -v 3 

Time for processing: 0h 0m 0s 0ms
offsetalignment /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/q_orfs_aa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/t_orfs_aa /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/aln /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/result --chain-alignments 0 --merge-query 1 --search-type 2 --threads 48 --compressed 0 --db-load-mode 0 -v 3 

Computing ORF lookup
Computing contig offsets
Computing contig lookup
Time for contig lookup: 0h 0m 0s 5ms
Writing results to: /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/result
[=================================================================] 2.98K 0s 53ms

Time for merging to result: 0h 0m 0s 71ms
Time for processing: 0h 0m 0s 323ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/q_orfs_aa -v 3 

Time for processing: 0h 0m 0s 3ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/t_orfs_aa -v 3 

Time for processing: 0h 0m 0s 5ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/search_tmp/15191071156062722874/aln -v 3 

Time for processing: 0h 0m 0s 90ms
/nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_clusters.m8 exists and will be overwritten
convertalis /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/result /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_clusters.m8 --sub-mat 'aa:blosum62.out,nucl:nucleotide.out' --format-mode 4 --format-output query,target,fident,nident,alnlen,qlen,tlen,evalue --translation-table 1 --gap-open aa:11,nucl:5 --gap-extend aa:1,nucl:2 --db-output 0 --db-load-mode 0 --search-type 2 --threads 48 --compressed 0 -v 3 

[=================================================================] 2.98K 0s 49ms
Time for merging to mmseqs_clusters.m8: 0h 0m 0s 124ms
Time for processing: 0h 0m 0s 312ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/result -v 3 

Time for processing: 0h 0m 0s 46ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target -v 3 

Time for processing: 0h 0m 0s 3ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/target_h -v 3 

Time for processing: 0h 0m 0s 2ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query -v 3 

Time for processing: 0h 0m 0s 4ms
rmdb /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/merged_multi_test/mmseqs_tmp/9248489994028336815/query_h -v 3 

Time for processing: 0h 0m 0s 3ms
                                                   0
0  /nfs/research/jlees/jacqueline/atb_analyses/me...
1  /nfs/research/jlees/jacqueline/atb_analyses/me...
n_graphs:  2
/nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_1
graph_file_1:  /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_1/final_graph.gml
graph_file_2:  /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_2/final_graph.gml
applying gene data...
applying rename...
gene_data_g2:                          annotation_id clustering_id_indiv
0        SAMEA4394894.contigs.fa_4077               0_0_0
1        SAMEA4394894.contigs.fa_5336               0_0_1
2       SAMEA4394894.contigs.fa_11713               0_0_2
3        SAMEA4394894.contigs.fa_7042               0_0_3
4       SAMEA4394894.contigs.fa_10949               0_0_4
...                               ...                 ...
171964   SAMEA3671767.contigs.fa_6851             66_23_0
171965   SAMEA3671767.contigs.fa_2143             66_23_1
171966  SAMEA3671767.contigs.fa_12488             66_24_0
171967   SAMEA3671767.contigs.fa_5222             66_25_0
171968   SAMEA3671767.contigs.fa_7424             66_26_0

[171969 rows x 2 columns]
applying match...
matches_g2                           annotation_id clustering_id_all clustering_id_indiv
0        SAMEA104281543.contigs.fa_8609             0_0_0                 NaN
1        SAMEA104281543.contigs.fa_2399             0_0_1                 NaN
2       SAMEA104281543.contigs.fa_13607             0_0_2                 NaN
3       SAMEA104281543.contigs.fa_10654             0_0_3                 NaN
4        SAMEA104281543.contigs.fa_4484             0_0_4                 NaN
...                                 ...               ...                 ...
361912    SAMN02203235.contigs.fa_12950          140_76_0             38_76_0
361913     SAMN02203235.contigs.fa_9100          140_77_0             38_77_0
361914      SAMN02203235.contigs.fa_441          140_78_0             38_78_0
361915     SAMN02203235.contigs.fa_4674          140_79_0             38_79_0
361916     SAMN02203235.contigs.fa_6922          140_80_0             38_80_0

[361917 rows x 3 columns]
applying dropna...
matches_g2                           annotation_id clustering_id_all clustering_id_indiv
2612     SAMEA104281623.contigs.fa_7228             1_0_0              37_0_0
2613    SAMEA104281623.contigs.fa_14180             1_0_1              37_0_1
2614     SAMEA104281623.contigs.fa_1352             1_0_2              37_0_2
2615     SAMEA104281623.contigs.fa_3364             1_0_3              37_0_3
2616    SAMEA104281623.contigs.fa_14412             1_0_4              37_0_4
...                                 ...               ...                 ...
361912    SAMN02203235.contigs.fa_12950          140_76_0             38_76_0
361913     SAMN02203235.contigs.fa_9100          140_77_0             38_77_0
361914      SAMN02203235.contigs.fa_441          140_78_0             38_78_0
361915     SAMN02203235.contigs.fa_4674          140_79_0             38_79_0
361916     SAMN02203235.contigs.fa_6922          140_80_0             38_80_0

[171969 rows x 3 columns]
applying gidmap...
applying ind...
pangenome_reference_g1:  /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_1/pan_genome_reference.fa
pangenome_reference_g2:  /nfs/research/jlees/jacqueline/atb_analyses/merge_tests/staph_merge/graph_2/pan_genome_reference.fa
Running mmseqs2...
mmseqs2 complete. Reading and filtering results...
Filtered mmseqs...
mmseqs:            target       query  fident  nident  alnlen  qlen  tlen         evalue
0        group_0  group_1423     1.0     204     204   615   615  3.394000e-132
1        group_1  group_1424     1.0     204     204   615   615  4.801000e-129
2       group_10  group_1438     1.0     200     200   603   603  3.288000e-127
3      group_100  group_1556     1.0     178     178   537   537  4.813000e-112
4     group_1000    group_89     1.0     667     667  2004  2004   0.000000e+00
...          ...         ...     ...     ...     ...   ...   ...            ...
2811   group_995    group_79     1.0     686     686  2061  2061   0.000000e+00
2812   group_996    group_82     1.0     680     680  2043  2043   0.000000e+00
2813   group_997    group_83     1.0     678     678  2037  2037   0.000000e+00
2814   group_998    group_84     1.0     677     677  2034  2034   0.000000e+00
2815   group_999    group_86     1.0     669     669  2010  2010   0.000000e+00

[2816 rows x 8 columns]
does not have node group_52
node_group group_52
